<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>GitHub Excel íŒŒì¼ + ì‹œíŠ¸ ì„ íƒ ë³´ê¸°</title>

  <!-- âœ… SheetJS ë¼ì´ë¸ŒëŸ¬ë¦¬ (ì—‘ì…€ ì½ê¸°ìš©) -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
    }
    select, button {
      font-size: 16px;
      padding: 6px 10px;
      margin-right: 10px;
    }
    h2, h3 {
      color: #333;
    }
    table {
      border-collapse: collapse;
      width: 90%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #999;
      padding: 6px 12px;
      text-align: center;
    }
    th {
      background-color: #f4f4f4;
    }
  </style>
</head>
<body>
  <h2>GitHub Excel íŒŒì¼ + ì‹œíŠ¸ ì„ íƒ í›„ ë³´ê¸°</h2>

  <!-- ğŸ”½ Excel íŒŒì¼ ì„ íƒ -->
  <select id="fileSelect">
    <option value="">-- Excel íŒŒì¼ ì„ íƒ --</option>
    <option value="I24_excel_2025.xlsx">I24_excel_2025_xlsx</option>
    <option value="sample2.xlsx">sample2.xlsx</option>
    <option value="sample3.xlsx">sample3.xlsx</option>
  </select>

  <!-- ğŸ”½ ì‹œíŠ¸ ì„ íƒ -->
  <select id="sheetSelect" disabled>
    <option value="">-- ì‹œíŠ¸ ì„ íƒ --</option>
  </select>

  <!-- ğŸ”½ ë²„íŠ¼ -->
  <button onclick="loadExcel()">ë¶ˆëŸ¬ì˜¤ê¸°</button>

  <!-- ğŸ”½ ê²°ê³¼ í‘œì‹œ -->
  <div id="output"></div>

  <script>
    let currentWorkbook = null;

    // âœ… ë¹ˆ ì…€ë„ í¬í•¨í•´ ëª¨ë“  ì…€ì„ 2ì°¨ì› ë°°ì—´ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜ 2025.11.01 pm9 ì¶”ê°€í•¨
function sheetToFullArray(sheet) {
  const range = XLSX.utils.decode_range(sheet['!ref']);
  const data = [];

  for (let R = range.s.r; R <= range.e.r; ++R) {
    const row = [];
    for (let C = range.s.c; C <= range.e.c; ++C) {
      const cellAddress = XLSX.utils.encode_cell({ r: R, c: C });
      const cell = sheet[cellAddress];
      row.push(cell ? cell.v : ""); // ë¹ˆ ì…€ì„ ""ìœ¼ë¡œ ì±„ì›€
    }
    data.push(row);
  }
  return data;
}

    // âœ… Excel íŒŒì¼ ì„ íƒ ì‹œ ì‹œíŠ¸ ëª©ë¡ ì½ê¸°
    document.getElementById("fileSelect").addEventListener("change", async function() {
      const fileName = this.value;
      if (!fileName) {
        document.getElementById("sheetSelect").disabled = true;
        document.getElementById("sheetSelect").innerHTML = "<option>-- ì‹œíŠ¸ ì„ íƒ --</option>";
        return;
      }

      // const fileUrl = "https://username.github.io/web_test1/" + fileName;
      const fileUrl = "https://victor4friend-eng.github.io/web_test1/" + fileName;
      try {
        const response = await fetch(fileUrl);
        if (!response.ok) throw new Error("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

        const arrayBuffer = await response.arrayBuffer();

        // âœ… Workbook ì½ê¸°
        currentWorkbook = XLSX.read(arrayBuffer, { type: "array" });

        // âœ… ì‹œíŠ¸ ëª©ë¡ ë“œë¡­ë‹¤ìš´ ê°±ì‹ 
        const sheetSelect = document.getElementById("sheetSelect");
        sheetSelect.innerHTML = "";
        currentWorkbook.SheetNames.forEach(name => {
          const opt = document.createElement("option");
          opt.value = name;
          opt.textContent = name;
          sheetSelect.appendChild(opt);
        });
        sheetSelect.disabled = false;

      } catch (error) {
        alert("ì˜¤ë¥˜: " + error.message);
      }
    });

    // âœ… ì‹œíŠ¸ ë‚´ìš©ì„ í™”ë©´ì— ì¶œë ¥
    function loadExcel() {
      const fileName = document.getElementById("fileSelect").value;
      const sheetName = document.getElementById("sheetSelect").value;
      if (!fileName || !sheetName) {
        alert("Excel íŒŒì¼ê³¼ ì‹œíŠ¸ë¥¼ ëª¨ë‘ ì„ íƒí•˜ì„¸ìš”!");
        return;
      }

      const sheet = currentWorkbook.Sheets[sheetName];
      const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

      // âœ… HTML í…Œì´ë¸”ë¡œ ë³€í™˜
      let html = `<h3>${fileName} - ${sheetName}</h3>`;
      html += "<table>";
      jsonData.forEach((row, i) => {
        html += "<tr>";
        row.forEach(cell => {
          html += i === 0
            ? `<th>${cell ?? ""}</th>`
            : `<td>${cell ?? ""}</td>`;
        });
        html += "</tr>";
      });
      html += "</table>";

      document.getElementById("output").innerHTML = html;
    }
  </script>
</body>
</html>

