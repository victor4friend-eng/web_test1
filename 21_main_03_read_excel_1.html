<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>GitHub Excel íŒŒì¼ ì„ íƒ í›„ ë¶ˆëŸ¬ì˜¤ê¸°</title>

  <!-- SheetJS (ì—‘ì…€ íŒŒì¼ ì½ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬) CDN -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    select, button {
      font-size: 16px;
      padding: 6px 10px;
      margin-right: 10px;
    }
    table {
      border-collapse: collapse;
      width: 90%;
      margin-top: 20px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 5px 10px;
      text-align: center;
    }
    th {
      background-color: #f2f2f2;
    }
  </style>
</head>
<body>
  <h2>GitHub Excel íŒŒì¼ ì„ íƒ í›„ ë³´ê¸°</h2>

  <!-- ğŸ”½ Excel íŒŒì¼ ì„ íƒ -->
  <select id="fileSelect">
    <option value="">-- Excel íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš” --</option>
    <option value="I24_excel_2025.xlsx">I24_excel_2025_xlsx</option>
    <option value="sample2.xlsx">sample2.xlsx</option>
    <option value="sample3.xlsx">sample3.xlsx</option>
  </select>

  <!-- ğŸ”½ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ -->
  <button onclick="loadExcel()">ë¶ˆëŸ¬ì˜¤ê¸°</button>

  <!-- ğŸ”½ ì¶œë ¥ ì˜ì—­ -->
  <div id="output"></div>

  <script>
    async function loadExcel() {
      const fileName = document.getElementById("fileSelect").value;
      if (!fileName) {
        alert("ë¨¼ì € Excel íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”!");
        return;
      }

      // GitHub Pagesì˜ Excel íŒŒì¼ ì£¼ì†Œ
      const fileUrl = "https://victor4friend-eng.github.io/web_test1/" + fileName;

      try {
        const response = await fetch(fileUrl);
        if (!response.ok) throw new Error("íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");

        const arrayBuffer = await response.arrayBuffer();

        // Excel ë°ì´í„° ì½ê¸°
        const workbook = XLSX.read(arrayBuffer, { type: "array" });

        // ì²« ë²ˆì§¸ ì‹œíŠ¸ ì„ íƒ
        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];

        // ì‹œíŠ¸ë¥¼ JSONìœ¼ë¡œ ë³€í™˜
        const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        // HTML í…Œì´ë¸”ë¡œ ë³€í™˜
        let html = `<h3>${fileName} (${sheetName})</h3>`;
        html += "<table>";
        jsonData.forEach((row, i) => {
          html += "<tr>";
          row.forEach(cell => {
            html += i === 0
              ? `<th>${cell ?? ""}</th>`
              : `<td>${cell ?? ""}</td>`;
          });
          html += "</tr>";
        });
        html += "</table>";

        document.getElementById("output").innerHTML = html;
      } catch (error) {
        document.getElementById("output").innerHTML = "ì˜¤ë¥˜ ë°œìƒ: " + error.message;
      }
    }
  </script>
</body>
</html>

